<html>
  <head>
    <title>Aleatoric note spammer</title>
    <script src="https://unpkg.com/@webcomponents/webcomponentsjs@^2/webcomponents-bundle.js"></script>
    <script src="https://unpkg.com/tone"></script>
    <script src="https://unpkg.com/@tonejs/ui"></script>
  </head>

  <body>
    <button id='play' onclick="playing = !playing"></button>

    <br><br>
    <i>Yoinked / adapted from the <a href="https://tonejs.github.io/">Tone.js docs</a></i>

    <script>
      var fmProperties = {
        "modulationIndex": 12.22,
        "envelope": {
          "attack": 0.01,
          "decay": 0.2
        },
        "modulation": {
          "type": "square"
        },
        "modulationEnvelope": {
          "attack": 0.2,
          "decay": 0.01
        }
      }
      var synth = new Tone.FMSynth(fmProperties).toMaster()
      playing = false

      var update = function() {
        if(playing) {
          var rnd = Math.random() * 900 + 20
          synth.triggerAttackRelease(rnd, '6n', "+0", 0.2)
        }
        document.querySelector('#play').textContent = playing ? "Stop" : "Play"
        window.setTimeout(update, 500)
      }

      update()
    </script>
  </body>
</html>
